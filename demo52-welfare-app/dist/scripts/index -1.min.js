"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};$(function(){window.Base;var p=window.Config||{},u=window.MapTree||{},e=window.LayerGroup||{},n=window.MapSearch||{},s=window.MapMeasure;p={target:"mapCon",TileName:"谷歌经纬度影像19",tName:"MapGIS Of SMX",docName:"12345",mName:"MapGIS Of 12345",user:"",password:"",ip:"10.160.237.77",port:"6163",center:[111.1928,34.7808],projection4:"EPSG:4326",projection3:"EPSG:3857",zoom:14,minZoom:13,maxZoom:19,rotation:0,origin:[-180,-90],tileSize:256,crossOrigin:"anonymous",mousePosition:"mouse-position",extend:[111.13227664319722,34.712871905272884,111.27904811225743,34.80599655079968],mapTreeId:"container_left_content",zoomInBtnGroups:"#zoom-in",zoomOutBtnGroups:"#zoom-out",zoomRestoreBtnGroups:"#restore",mapArray:[u.layer_vec,u.layer_cva,u.layer_img,u.layer_cia,u.mapDocLayer],deepClone:function(e){var t,r=e.constructor===Array?[]:{};if("object"===(void 0===e?"undefined":_typeof(e))){if(window.JSON)t=JSON.stringify(e),r=JSON.parse(t);else for(var o in e)r[o]="object"===_typeof(e[o])?this.deepClone(e[o]):e[o];return r}}},u={layer:[],layerName:[],layerVisibility:[],formatData:[],themesInfoArrs:{first:"",second:"",third:""},layer_vec:new Zondy.Map.TianDiTu({layerType:Zondy.Enum.Map.TiandituType.VEC,projection:ol.proj.get(p.projection4),ip:p.ip,port:p.port,tileSize:p.tileSize,crossOrigin:p.crossOrigin}),layer_cva:new Zondy.Map.TianDiTu({layerType:Zondy.Enum.Map.TiandituType.CVA,projection:ol.proj.get(p.projection4),ip:p.ip,port:p.port,tileSize:p.tileSize,crossOrigin:p.crossOrigin}),layer_img:new Zondy.Map.TileLayer(p.tName,p.TileName,{ip:p.ip,port:p.port}),layer_cia:new Zondy.Map.TianDiTu({layerType:Zondy.Enum.Map.TiandituType.CIA,projection:ol.proj.get(p.projection4),ip:p.ip,port:p.port,tileSize:p.tileSize,crossOrigin:p.crossOrigin}),mapDocLayer:new Zondy.Map.Doc(p.mName,p.docName,{ip:p.ip,port:p.port})},n={query_drawLayer:null,drawLayer:null,vectorLayer:null,vectorSource:null,oper:null,querypoint:null,popup:null,querytype:0},s={draw:"",measuertype:null,measuerVector:null,measure_source:null,wgs84Sphere:new ol.Sphere(6378137),sketch:null,helpTooltipElement:null,helpTooltip:null,measureTooltipElement:null,measureTooltip:null,continuePolygonMsg:"鼠标单击绘制多边形",continueLineMsg:"鼠标单击绘制线"},{getMapInfos:!(e={imgLayergroup:new ol.layer.Group({layers:[u.layer_img,u.layer_cia]}),vecLayergroup:new ol.layer.Group({layers:[u.layer_vec,u.layer_cva]}),dataLayergroup:null}),roadResults:null,themeActive:"",acitiveSearch:"",themesInfoArrs:[],themesInfoArrs1:[],views:{view:function(){return this.map.getView()},zoom:function(){return this.map.getZoom()}},map:new ol.Map({target:p.target,layers:[u.layer_vec,u.layer_cva,u.layer_img,u.layer_cia,u.mapDocLayer],view:new ol.View({center:p.center,zoom:p.zoom,projection:p.projection4,minZoom:p.minZoom,maxZoom:p.maxZoom,rotation:p.rotation,extent:p.extend}),controls:ol.control.defaults({attributionOptions:{collapsible:!0}}).extend([new ol.control.MousePosition({coordinateFormat:ol.coordinate.createStringXY(4),projection:p.projection4,className:"custom-mouse-position",target:document.getElementById(p.mousePosition),undefinedHTML:"&nbsp;"}),new ol.control.ZoomToExtent({extent:p.extend})])}),loadLayersControl:function(e,t){for(var r=this,o=u,a=document.getElementById(t),n=e.getLayers(),l=0;l<n.getLength();l++)if(n.array_[l].name){o.layer[l]=n.item(l),o.layerName[l]=o.layer[l].get("name"),o.layerVisibility[l]=o.layer[l].getVisible();var i=document.createElement("li");a.appendChild(i);var c=document.createElement("input");c.type="checkbox",c.name="layers",i.appendChild(c);var s=document.createElement("label");s.className="layer",r.setInnerText(s,o.layerName[l]),i.appendChild(s),o.layerVisibility[l]&&(c.checked=!0),r.addChangeEventMapDoc(c,o.layer[l])}r.getMapInfo()},addChangeEventMapDoc:function(e,t){e.onclick=function(){e.checked?t.setVisible(!0):t.setVisible(!1)}},addChangeEventLayer:function(e){var t=e.getAttribute("data-index");e.onclick=function(){e.checked?u.mapDocLayer.setLayerStatus(t,"include"):u.mapDocLayer.setLayerStatus(t,"exclude"),u.mapDocLayer.refresh()}},addChangeEventAttr:function(e){var t=this,r=e.getAttribute("data-index1"),o=e.getAttribute("data-index2"),a=e.getAttribute("data-index3");e.onclick=function(){0==r?(e.checked?t.themesInfoArrs[0].ThemeArr[0].UniqueThemeInfoArr[a].IsVisible=!0:t.themesInfoArrs[0].ThemeArr[0].UniqueThemeInfoArr[a].IsVisible=!1,n.oper.updateThemesInfo(t.themeActive,r+"/"+o,t.themesInfoArrs,t.onUniqueTheme.bind(t))):3==r&&(e.checked?t.themesInfoArrs1[0].ThemeArr[0].UniqueThemeInfoArr[a].IsVisible=!0:t.themesInfoArrs1[0].ThemeArr[0].UniqueThemeInfoArr[a].IsVisible=!1,n.oper.updateThemesInfo(t.themeActive,r+"/"+o,t.themesInfoArrs1,t.onUniqueTheme.bind(t)))}},addChangeEventTheme:function(e){var t=this,r=e.getAttribute("data-index1"),o=e.getAttribute("data-index2");e.onclick=function(){e.checked?t.themesInfoArrs[r].ThemeArr[o].Visible=!0:t.themesInfoArrs[r].ThemeArr[o].Visible=!1,n.oper.updateThemesInfo(t.themeActive,r+"/"+o,t.themesInfoArrs,t.onUniqueTheme.bind(t))}},onUniqueTheme:function(e){if(!e)return!1;u.mapDocLayer.refresh()},setInnerText:function(e,t){"string"==typeof e.textContent?e.textContent=t:e.innerText=t},zoomOut:function(){var e=this.map.getView(),t=e.getZoom();e.setZoom(t-1)},zoomIn:function(){var e=this.map.getView(),t=e.getZoom();e.setZoom(t+1)},translation:function(){var e=this.map.getView();e.getZoom();e.setCenter([111.2,34.76])},restore:function(){var e=this.map.getView();e.setCenter(p.center),e.setRotation(p.rotation),e.setZoom(p.zoom)},clickEventsGroups:function(){var e=this;$(p.zoomOutBtnGroups).on("click",function(){e.zoomOut()}),$(p.zoomInBtnGroups).on("click",function(){e.zoomIn()}),$("#panto").on("click",function(){e.translation()}),$(p.zoomRestoreBtnGroups).on("click",function(){e.restore()})},operInit:function(){var e=u,t=p;n.oper=new Zondy.Service.ThemeOper,n.oper.ip=t.ip,n.oper.port=t.port,n.oper.guid=e.mapDocLayer.source.guid},getMapInfo:function(){new Zondy.Service.Catalog.MapDoc({ip:p.ip,port:p.port,docName:p.docName,mapIndex:0,returnFullStyle:!0}).getMapInfo(this.getListSuccess.bind(this),!0,!0)},getListSuccess:function(e){var n=this,t=u;if(0==e.length)return alert("没有获取到矢量地图文档！"),void $("#reslutTable").empty();if(!n.getMapInfos){t.formatData=JSON.parse(e.attribute[0].value);var r="#"+p.mapTreeId,o=JSON.parse(e.attribute[0].value),a=$(r).children("li").length,l=$(r).children("li")[a-1],i=document.createElement("ul");o.forEach(function(e,t){if(e){var r=document.createElement("li");i.appendChild(r);var o=document.createElement("input");o.type="checkbox",o.checked=!0,o.setAttribute("data-index",t),r.appendChild(o);var a=document.createElement("label");a.className="layer",e.attributeArr.forEach(function(e,t){"name"==e.name&&(o.name=e.value,a.innerText=e.value)}),r.appendChild(a),n.addChangeEventLayer(o)}}),l.appendChild(i),n.getMapInfos=!0,n.updateTheme(),n.updateTheme1(),n.updateTheme2()}},updateTheme:function(){var s=this;n.oper.getThemesInfo(p.docName,"0/0",function(e){if(s.themesInfoArrs=e,s.themeActive=p.docName,0<e.length&&null!=e[0].ThemeArr){var t="#"+p.mapTreeId,r=$(t).children("li").length,a=$(t).children("li").eq(r-1).children("ul").children("li")[0],c=document.createElement("ul");e.forEach(function(e,i){e.ThemeArr.forEach(function(e,n){var t=e.UniqueThemeInfoArr,r=document.createElement("ul"),l=document.createElement("li");r.appendChild(l);var o=document.createElement("label");o.className="layer",o.innerText=e.Name,l.appendChild(o),t.forEach(function(e,t){var r=document.createElement("li");c.appendChild(r);var o=document.createElement("input");o.type="checkbox",o.checked=!0,o.setAttribute("data-index1",i),o.setAttribute("data-index2",n),o.setAttribute("data-index3",t),r.appendChild(o);var a=document.createElement("label");a.className="layer",a.innerText=e.Caption,r.appendChild(a),s.addChangeEventAttr(o),l.appendChild(c)}),a.appendChild(r)})})}else alert("没有该专题信息")})},updateTheme1:function(){var u=this;n.oper.getThemesInfo(p.docName,"2/0",function(e){if(u.themesInfoArrs1=e,u.themeActive=p.docName,0<e.length&&null!=e[0].ThemeArr){var t="#"+p.mapTreeId,r=$(t).children("li").length,a=$(t).children("li").eq(r-1).children("ul").children("li")[2],c=$(t).children("li").eq(r-1).children("ul").children("li").eq(2).children("input").attr("data-index"),s=document.createElement("ul");e.forEach(function(e,t){e.ThemeArr.forEach(function(e,l){var t=e.UniqueThemeInfoArr,r=document.createElement("ul"),i=document.createElement("li");r.appendChild(i);var o=document.createElement("label");o.className="layer",o.innerText=e.Name,i.appendChild(o),t.forEach(function(e,t){var r=document.createElement("li");s.appendChild(r);var o=document.createElement("input"),a=document.createElement("input");o.type="checkbox",a.type="color",o.checked=!0,a.disabled=!0,0==t&&(a.value="#00FF00"),1==t&&(a.value="#00B7D7"),2==t&&(a.value="#F7B5CB"),3==t&&(a.value="#F200A5"),o.setAttribute("data-index1",c),o.setAttribute("data-index2",l),o.setAttribute("data-index3",t),a.setAttribute("data-colorCode",e.LinInfo.OutClr[0]),a.setAttribute("data-index",t),r.appendChild(o);var n=document.createElement("label");n.className="layer",n.innerText=e.Caption,r.appendChild(n),r.appendChild(a),u.addChangeEventAttr(o),i.appendChild(s)}),a.appendChild(r)})})}else alert("没有该专题信息")})},updateTheme2:function(){var u=this;n.oper.getThemesInfo(p.docName,"3/0",function(e){if(u.themesInfoArrs1=e,u.themeActive=p.docName,0<e.length&&null!=e[0].ThemeArr){var t="#"+p.mapTreeId,r=$(t).children("li").length,a=$(t).children("li").eq(r-1).children("ul").children("li")[3],c=$(t).children("li").eq(r-1).children("ul").children("li").eq(3).children("input").attr("data-index"),s=document.createElement("ul");e.forEach(function(e,t){e.ThemeArr.forEach(function(e,l){var t=e.UniqueThemeInfoArr,r=document.createElement("ul"),i=document.createElement("li");r.appendChild(i);var o=document.createElement("label");o.className="layer",o.innerText=e.Name,i.appendChild(o),t.forEach(function(e,t){var r=document.createElement("li");s.appendChild(r);var o=document.createElement("input"),a=document.createElement("input");o.type="checkbox",a.type="color",o.checked=!0,a.disabled=!0,0==t&&(a.value="#FFBFA3"),1==t&&(a.value="#FFDF87"),o.setAttribute("data-index1",c),o.setAttribute("data-index2",l),o.setAttribute("data-index3",t),a.setAttribute("data-colorCode",e.LinInfo.OutClr[0]),a.setAttribute("data-index",t),r.appendChild(o);var n=document.createElement("label");n.className="layer",n.innerText=e.Caption,r.appendChild(n),r.appendChild(a),u.addChangeEventAttr(o),i.appendChild(s)}),a.appendChild(r)})})}else alert("没有该专题信息")})},toggleMenu:function(){$(".menu-trigger").hasClass("on")?($(".menu-trigger").removeClass("on").addClass("off"),$(".container_left").css("left","-20%"),$(".menu-trigger").text("》")):($(".menu-trigger").removeClass("off").addClass("on"),$(".menu-trigger").text("《"),$(".container_left").css("left",0))},mapListInit:function(){$("#vecmap").css("border-color","rgba(255, 255, 255,0.8)"),$("#imgmap").css("border-color","rgba(0, 255, 255,0.8)")},queryByAttribute:function(e){var t=new Zondy.Service.QueryFeatureStruct;t.IncludeGeometry=!0;var r=new Zondy.Service.QueryParameter({resultFormat:"json",struct:t});r.pageIndex=0,r.recordNumber=50;var o="name like '%"+e+"%'";r.where=o,new Zondy.Service.QueryDocFeature(r,p.docName,4,{ip:p.ip,port:p.port}).query(this.querySuccess.bind(this),this.queryError.bind(this))},roadQueryByAttribute:function(e){var t=this;t.startPressBar(),t.clearA();var r=new Zondy.Service.QueryFeatureStruct;r.IncludeGeometry=!0,r.IncludeAttribute=!0,r.IncludeWebGraphic=!1;var o=new Zondy.Service.QueryParameter({resultFormat:"json",struct:r});o.pageIndex=0,o.recordNumber=60;var a="name like '%"+e+"%'";o.where=a,new Zondy.Service.QueryDocFeature(o,p.docName,2,{ip:p.ip,port:p.port}).query(t.roadQuerySuccess.bind(t),t.queryError.bind(t))},roadQuerySuccess:function(e){var t=this;console.log(e),$("#reslutTable ul").html(""),t.roadResults=e,t.stopPressBar();JSON.stringify(e);var r=e.AttStruct.FldName,o=e.SFEleArray,a="",n="",l="",i="";if(r.forEach(function(e,t){"NAME"==e.toUpperCase()&&(n=t),"WIDTH"==e.toUpperCase()&&(l=t),"property_type"==e.toLowerCase()&&(i=t),"region"==e.toUpperCase()&&t}),0<=n&&o){t.clearA();for(var c=0;c<o.length;c++){var s=o[c].AttValue,u=o[c].bound;a+='\n                        <li data-index="'+c+'" data-width="'+s[l]+'" data-id="'+s[i]+'" data-xmax="'+(u.xmax+u.xmin)/2+'" data-ymax="'+(u.ymax+u.ymin)/2+'">\n                            <p>'+s[n]+'</p>\n                            <p style="display:none">'+s[l]+"</p>\n                            <p>"+s[i]+'</p>\n                            <p style="display:none">'+u.xmax+'</p>\n                            <p style="display:none">'+u.ymax+"</p>\n                        </li>"}$("#reslutTable ul").html(a),$("#reslutTable ul li:eq(0)").addClass("search-active");var p=(new Zondy.Format.PolygonJSON).read(e),m=new ol.source.Vector({wrapX:!1});m.addFeatures(p),t.drawLayer=new ol.layer.Vector({source:m,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 0, 0, 0.5)"}),stroke:new ol.style.Stroke({color:"rgba(255,0, 0, 1)",width:10})})}),t.map.addLayer(t.drawLayer)}else a='<li class="no-datas">暂无搜索结果</li>',$("#reslutTable ul").html(a)},queryError:function(e){this.stopPressBar()},querySuccess:function(e){var t=this,r=[];$("#reslutTable ul").html(""),t.stopPressBar();JSON.stringify(e);var o=e.AttStruct.FldName,a=e.SFEleArray,n="",l="",i="",c="",s="";if(o.forEach(function(e,t){"NAME"==e.toUpperCase()&&(l=t),"ADDNAME"==e.toUpperCase()&&(i=t),"LON"==e.toUpperCase()&&(c=t),"LAT"==e.toUpperCase()&&(s=t)}),0<=l&&0<=i&&0<=c&&0<=s&&a){t.clearA();for(var u=0;u<a.length;u++){var p=a[u].AttValue,m=p[c]-0,d=p[s]-0,h=p[l],y=new ol.Feature({geometry:new ol.geom.Point([m,d]),name:h});y.setStyle(t.createLabelStyle(y)),r.push(y),n+='\n                <li data-lon="'+p[c]+'" data-lat="'+p[s]+'">\n                    <p>'+p[l]+"</p>\n                    <p>"+p[i]+'</p>\n                    <p style="display:none;">'+p[c]+'</p>\n                    <p style="display:none;>'+p[s]+"</p>\n                </li>"}$("#reslutTable ul").html(n),t.vectorSource=new ol.source.Vector({features:r}),t.vectorLayer=new ol.layer.Vector({source:t.vectorSource}),t.map.addLayer(t.vectorLayer)}else n='<li class="no-datas">暂无搜索结果</li>',$("#reslutTable ul").html(n)},createLabelStyle:function(e){return new ol.style.Style({image:new ol.style.Icon({anchor:[.5,.1],anchorOrigin:"bottom-left",anchorXUnits:"fraction",anchorYUnits:"pixels",offsetOrigin:"bottom-left",scale:.3,opacity:1,src:"images/location-1.png"}),text:new ol.style.Text({textAlign:"center",textBaseline:"middle",font:"normal 12px 微软雅黑",text:e.get("name"),fill:new ol.style.Fill({color:"#aa3300"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:2})})})},clearA:function(){var e=this;e.stopPressBar(),e.vectorLayer&&(e.vectorSource=null,e.vectorLayer.setSource(e.vectorSource),e.map.addLayer(e.vectorLayer)),e.drawLayer&&(e.drawSource=null,e.drawLayer.setSource(e.drawSource),e.map.addLayer(e.drawLayer)),e.drawLayer1&&(e.drawSource=null,e.drawLayer1.setSource(e.drawSource),e.map.addLayer(e.drawLayer1))},stopPressBar:function(){$("#preview").css("display","none")},startPressBar:function(){$("#preview").css("display","block")},pointerMoveHandler:function(e){var t=s;if(!e.dragging){var r="鼠标单击开始绘制";if(t.sketch){var o=t.sketch.getGeometry();o instanceof ol.geom.Polygon?r=t.continuePolygonMsg:o instanceof ol.geom.LineString&&(r=t.continueLineMsg)}t.helpTooltipElement.innerHTML=r,t.helpTooltip.setPosition(e.coordinate),$(t.helpTooltipElement).removeClass("hidden")}},addInteraction:function(){var t,a=s,n=this,e="面积测量"==a.measuertype?"Polygon":"LineString";a.draw=new ol.interaction.Draw({source:a.measure_source,type:e,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new ol.style.Circle({radius:5,stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.7)"}),fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"})})})}),n.map.addInteraction(a.draw),n.createMeasureTooltip(),n.createHelpTooltip(),a.draw.on("drawstart",function(e){a.sketch=e.feature;var o=e.coordinate;t=a.sketch.getGeometry().on("change",function(e){var t,r=e.target;r instanceof ol.geom.Polygon?(t=n.formatArea(r),o=r.getInteriorPoint().getCoordinates()):r instanceof ol.geom.LineString&&(t=n.formatLength(r),o=r.getLastCoordinate()),a.measureTooltipElement.innerHTML=t,a.measureTooltip.setPosition(o)})},this),a.draw.on("drawend",function(e){a.measureTooltipElement.className="tooltip tooltip-static",a.measureTooltip.setOffset([0,-7]),a.sketch=null,a.measureTooltipElement=null,n.createMeasureTooltip(),ol.Observable.unByKey(t)},this)},createHelpTooltip:function(){var e=s;e.helpTooltipElement&&e.helpTooltipElement.parentNode.removeChild(e.helpTooltipElement),e.helpTooltipElement=document.createElement("div"),e.helpTooltipElement.className="tooltip hidden",e.helpTooltip=new ol.Overlay({element:e.helpTooltipElement,offset:[15,0],positioning:"center-left"}),this.map.addOverlay(e.helpTooltip)},createMeasureTooltip:function(){var e=s;e.measureTooltipElement&&e.measureTooltipElement.parentNode.removeChild(e.measureTooltipElement),e.measureTooltipElement=document.createElement("div"),e.measureTooltipElement.className="tooltip tooltip-measure",e.measureTooltip=new ol.Overlay({element:e.measureTooltipElement,offset:[0,-15],positioning:"bottom-center"}),e.measureTooltip.cls,this.map.addOverlay(e.measureTooltip)},formatLength:function(e){for(var t=s,r=e.getCoordinates(),o=0,a=this.map.getView().getProjection(),n=0,l=r.length-1;n<l;++n){var i=ol.proj.transform(r[n],a,"EPSG:4326"),c=ol.proj.transform(r[n+1],a,"EPSG:4326");o+=t.wgs84Sphere.haversineDistance(i,c)}return 100<o?Math.round(o/1e3*100)/100+" km":Math.round(100*o)/100+" m"},formatArea:function(e){var t=s,r=this.map.getView().getProjection(),o=e.clone().transform(r,"EPSG:4326").getLinearRing(0).getCoordinates(),a=Math.abs(t.wgs84Sphere.geodesicArea(o));return 1e4<a?Math.round(a/1e6*100)/100+" km<sup>2</sup>":Math.round(100*a)/100+" m<sup>2</sup>"},resultChange:function(e){var t=this;if(e.hasClass("search-active")||e.addClass("search-active").siblings().removeClass("search-active"),1==t.acitiveSearch){var r=e.attr("data-lon")-0,o=e.attr("data-lat")-0;(u=t.map.getView()).getZoom();u.setZoom(15),u.setCenter([r,o])}else if(2==t.acitiveSearch){t.clearA();var a=e.attr("data-xmax")-0,n=e.attr("data-ymax")-0,l=(e.attr("data-id"),e.attr("data-index")),i=p.deepClone(t.roadResults);i.SFEleArray=[i.SFEleArray[l]],i.TotalCount=1;var c=(new Zondy.Format.PolygonJSON).read(i),s=new ol.source.Vector({wrapX:!1});s.addFeatures(c),t.drawLayer1=new ol.layer.Vector({source:s,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,0, 0, 1)"}),stroke:new ol.style.Stroke({color:"rgba(255,0, 0, 1)",width:12})})}),t.map.addLayer(t.drawLayer1);var u;(u=t.map.getView()).getZoom();u.setZoom(15),u.setCenter([a,n])}},init:function(){var r=this,o=s;r.loadLayersControl(r.map,p.mapTreeId),r.clickEventsGroups(),r.operInit(),r.mapListInit(),0<$(".menu-trigger").length&&$(".menu-trigger").on("click",function(){r.toggleMenu()}),$("#gis-search").on("click",function(){r.clearA(),r.acitiveSearch=1;var e=$("#search-input").val();e?(r.inputSearch=e,r.queryByAttribute(e),$("#reslutTable").show()):alert("您还没有输入信息呢！")}),$("#road-search").on("click",function(){r.clearA(),r.acitiveSearch=2;var e=$("#search-input").val();r.inputSearch&&r.map.removeLayer(r.vectorLayer),e?(r.inputSearch=e,r.roadQueryByAttribute(e),$("#reslutTable").show()):alert("您还没有输入信息呢！")}),$("#reslutTable>ul").on("click","li",function(){var e=$(this);r.resultChange(e)}),$("#vecmap").on("click",function(){e.vecLayergroup.getLayersArray()[0].setZIndex(-1),e.vecLayergroup.getLayersArray()[1].setZIndex(-1),e.imgLayergroup.getLayersArray()[0].setZIndex(-2),e.imgLayergroup.getLayersArray()[1].setZIndex(-2),$("#vecmap").css("border-color","rgba(0, 255, 255,0.8)"),$("#imgmap").css("border-color","rgba(255, 255, 255,0.8)")}),$("#close-search").on("click",function(){r.clearA(),$("#reslutTable").hide(),$("#reslutTable ul").html(""),r.map.removeLayer(r.vectorLayer)}),$("#imgmap").on("click",function(){e.imgLayergroup.getLayersArray()[0].setZIndex(-1),e.imgLayergroup.getLayersArray()[1].setZIndex(-1),e.vecLayergroup.getLayersArray()[0].setZIndex(-2),e.vecLayergroup.getLayersArray()[1].setZIndex(-2),$("#vecmap").css("border-color","rgba(255, 255, 255,0.8)"),$("#imgmap").css("border-color","rgba(0, 255, 255,0.8)")}),$(".commontool").find("span").click(function(){if($(this).parent().find("span").each(function(){$(this).removeClass("a_click")}),$(this).addClass("a_click"),null!=o.draw&&(r.map.removeInteraction(o.draw),o.draw=null),"退出测量"!=$(this).attr("title"))"距离测量"!=$(this).attr("title")&&"面积测量"!=$(this).attr("title")||(o.measuertype=$(this).attr("title"),null==o.meaurserVector&&(o.measure_source=new ol.source.Vector,o.meaurserVector=new ol.layer.Vector({source:o.measure_source,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.6)"}),stroke:new ol.style.Stroke({color:"#ff0000",width:5}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ff0000"})})})}),r.map.addLayer(o.meaurserVector)),r.map.on("pointermove",r.pointerMoveHandler),$(r.map.getViewport()).on("mouseout",function(){$(r.helpTooltipElement).addClass("hidden")}),r.addInteraction()),"地图导出"==$(this).attr("title")&&(document.execCommand("SaveAs"),r.map.once("postcompose",function(e){var t=e.context.canvas;navigator.msSaveBlob?navigator.msSaveBlob(t.msToBlob(),"map.png"):t.toBlob(function(e){})}),r.map.renderSync());else if(r.map.un("pointermove",r.pointerMoveHandler),o.helpTooltipElement&&(o.helpTooltipElement.parentNode.removeChild(o.helpTooltipElement),o.helpTooltipElement=null),o.meaurserVector&&(r.map.removeLayer(o.meaurserVector),o.meaurserVector=null,o.measure_source=null),o.measureTooltipElement){for(var e=r.map.getOverlays().getLength(),t=0;t<e;t++)r.map.removeOverlay(r.map.getOverlays().getArray()[0]);o.measureTooltipElement=null}}),$("#popup-closer").click(function(){return popup.setPosition(void 0),$("#popup-closer")[0].blur(),clearA(),!1}),$("#vecmap").click()}}.init()});
//# sourceMappingURL=index -1.js.map
