{"version":3,"sources":["newslists.js"],"names":["$","jQuery","support","cors","language","browserLanguage","window","Base","navigator","toLowerCase","site","e","versions","appVersion","t","match","weibo","wechat","indexOf","qq","trident","presto","webKit","gecko","mobile","ios","android","webApp","arguments","length","document","i","documentElement","n","fontSize","style","getPropertyValue","o","addEventListener","setSeo","this","getAjax","res","getComputedStyle","status","text","data","title","that","attr","message","alert","toggle","toggleClass","showNav","page","type","getQueryString","pagesLength","url","console","log","newsDatas","newsList","newsRightDatas","Configs","htmlLeft","count","config","ele","str_id","str_thumb","news_time","ceil","index","pagesHtml","html","metaHave","append","forEach","name","value","htmlRight","Math","str_title","smallTitle","addInfos","reg","r","context","bigTitle","ajax","next","datas","dataType","success","fns","postAjax","RegExp","location","search","substr","fail","fnf","getInfos","setCrumb","on","pages","init","hasClass"],"mappings":"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","file":"newslists.js","sourcesContent":["$(function () {\r\n    jQuery.support.cors = true;\r\n    let Base = window.Base || {};\r\n    Base = {\r\n        site: 'https://www.doubaner.top',\r\n        language: (navigator.browserLanguage || navigator.language).toLowerCase(),\r\n        versions: function () {\r\n            var e = navigator.userAgent, t = e.toLowerCase();\r\n            navigator.appVersion;\r\n            return {\r\n                wechat: \"micromessenger\" == t.match(/MicroMessenger/i),\r\n                qq: \"qq\" == t.match(/QQ/i),\r\n                weibo: \"weibo\" == t.match(/WeiBo/i),\r\n                trident: e.indexOf(\"Trident\") > -1,\r\n                presto: e.indexOf(\"Presto\") > -1,\r\n                webKit: e.indexOf(\"AppleWebKit\") > -1,\r\n                gecko: e.indexOf(\"Gecko\") > -1 && -1 == e.indexOf(\"KHTML\"),\r\n                mobile: !!e.match(/AppleWebKit.*Mobile.*/),\r\n                ios: !!e.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/),\r\n                android: e.indexOf(\"Android\") > -1 || e.indexOf(\"Linux\") > -1,\r\n                iPhone: e.indexOf(\"iPhone\") > -1,\r\n                iPad: e.indexOf(\"iPad\") > -1,\r\n                webApp: -1 == e.indexOf(\"Safari\")\r\n            }\r\n        }(),\r\n        fontSize: function () {\r\n            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : window, t = e.document,\r\n                i = t.documentElement, n = \"orientationchange\" in e ? \"orientationchange\" : \"resize\",\r\n                o = function () {\r\n                    var e = i.clientWidth || 375;\r\n                    e > 750 && (e = 750), i.style.fontSize = e / 7.5 + \"px\"\r\n                };\r\n            window.getComputedStyle(i, null).getPropertyValue(\"font-size\") <= \"20px\" && o(), t.addEventListener && (e.addEventListener(n, o, !1), t.addEventListener(\"DOMContentLoaded\", o, !1))\r\n        },\r\n        setSeo() {\r\n            let that = this;\r\n            that.getAjax('/seo', {}, function (res) {\r\n                console.log(res);\r\n                if (res.status == 200) {\r\n                    $(\"title\").text(res.data.title);\r\n                    $(\"meta[name='keywords']\").attr('content', res.data['keywords']);\r\n                    $(\"meta[name='description']\").attr('content', res.data['description']);\r\n                } else {\r\n                    alert(res.message);\r\n                }\r\n            })\r\n\r\n        },\r\n        showNav() {\r\n            $(\".common-header ol\").toggle();\r\n            $(\"body\").toggleClass('header-active');\r\n        },\r\n        pagesLength: 1,\r\n        page: 1,\r\n        getInfos(page = 1) {\r\n            let that = this;\r\n            let type = that.getQueryString('type');\r\n            let url = `/news/page/${page}/column/${type}`;\r\n            that.getAjax(url, {}, function (res) {\r\n                console.log(res);\r\n                if (res.status == 200) {\r\n                    let newsDatas = res.data.newsList;\r\n                    let newsRightDatas =\r\n                        res.data.rightNewsList;\r\n                    let config = res.data.Configs;\r\n                    let htmlLeft = '';\r\n                    let htmlRight = '';\r\n                    let count = res.data.count;\r\n                    let pagesHtml = '';\r\n                    if (newsDatas) {\r\n                        newsDatas.forEach(ele => {\r\n                            htmlLeft +=\r\n                                `<li>\r\n                                    <a href=\"./news.html?id=${ele.str_id}\">\r\n                                        <div class=\"img-infos\">\r\n                                            <img src=\"${that.site + ele.str_thumb}\" alt=\"\">\r\n                                            <span>${ele.news_time}</span>\r\n                                        </div>\r\n                                        <div class=\"des-infos\">\r\n                                            <h3>${ele.str_title}</h3>\r\n                                            <p>${ele.str_guide}</p>\r\n                                        </div>\r\n                                    </a>\r\n                                </li>`\r\n                        });\r\n                      that.pagesLength = Math.ceil(count / 8);\r\n                      for (let index = 1; index <= that.pagesLength; index++) {\r\n                        console.log(index);\r\n                        if (index == page) {\r\n                          pagesHtml += `<li class=\"active\" data-page=\"${index}\">${index}</li>`;\r\n                        } else {\r\n                          pagesHtml += `<li data-page=\"${index}\">${index}</li>`;\r\n                        }\r\n                      }\r\n                      $(\"#show-pages\").html(pagesHtml);\r\n                        $(\"#news-list-big>ul\").append(htmlLeft);\r\n\r\n                    } else {\r\n                        $(\"#news-list-big>ul\").append('<h1>Sorry,这里还什么都没有</h1>');\r\n                    }\r\n                    if (config) {\r\n                        config.forEach(ele => {\r\n                            let metaHave = `meta[name=\"${ele.name}\"]`;\r\n                            if (ele.name == 'title') {\r\n                                $(\"title\").text(ele.value);\r\n                            } else {\r\n                                if ($(metaHave)[0]) {\r\n                                    $(metaHave).attr('content', ele.value);\r\n                                } else {\r\n                                    $(\"head\").append(`<meta name=\"${ele.name}\" content=\"${ele.value}\" />`);\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                    if (newsRightDatas) {\r\n                        newsRightDatas.forEach(ele => {\r\n                            htmlRight +=\r\n                                `<li>\r\n                                    <a href=\"./news.html?id=${ele.str_id}\">\r\n                                        <div class=\"img-infos\">\r\n                                            <img src=\"${that.site + ele.str_thumb}\" alt=\"\">\r\n                                        </div>\r\n                                        <div class=\"des-infos\">\r\n                                            <h3>${ele.str_title}</h3>\r\n                                            <p>${ele.news_time}</p>\r\n                                        </div>\r\n                                        <img src=\"\" alt=\"\" class=\"icon\">\r\n                                    </a>\r\n                                </li>`\r\n                        });\r\n                        $(\"#news-list-small>ul\").append(htmlRight);\r\n                    } else {\r\n                        $(\"#news-list-small>ul\").append('<h1>Sorry,这里还什么都没有</h1>');\r\n                    }\r\n                    that.pagesLength = Math.ceil(count / 8);\r\n                } else {\r\n                    alert(res.message);\r\n                }\r\n            });\r\n        },\r\n        addInfos(){},\r\n        setCrumb() {\r\n            let that = this;\r\n            let type = that.getQueryString('type');\r\n            let bigTitle = $(\"#news-list-big h2 span\");\r\n            let smallTitle = $(\"#news-list-small h2 span\");\r\n            if (type == 9) {\r\n                bigTitle.text('公益行动');\r\n                smallTitle.text('公益明星').next().attr('href', '/newsList.html?type=8');\r\n            }else if (type ==8) {\r\n                bigTitle.text('公益明星');\r\n                smallTitle.text('公益行动').next().attr('href', '/newsList.html?type=9');\r\n            }\r\n        },\r\n        getQueryString: function (name) {\r\n            var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n            var r = window.location.search.substr(1).match(reg); //获取url中\"?\"符后的字符串并正则匹配\r\n            var context = \"\";\r\n            if (r != null)\r\n                context = r[2];\r\n            reg = null;\r\n            r = null;\r\n            return context == null || context == \"\" || context == \"undefined\" ? \"\" : context;\r\n        },\r\n        getAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"GET\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'JSON',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        postAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"POST\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'json',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        init() {\r\n            let that = this;\r\n            that.getInfos();\r\n            that.setCrumb();\r\n            that.fontSize();\r\n            that.setSeo();\r\n            $(\".common-header ul\").on('click', function () {\r\n                that.showNav();\r\n            });\r\n            $(\"#show-pages\").on('click', 'li', function () {\r\n                if ($(this).hasClass('active')) {\r\n                    return;\r\n                }\r\n                let pages = $(this).attr('data-page');\r\n                that.getInfos(pages);\r\n            });\r\n        }\r\n    }\r\n    Base.init();\r\n});"]}