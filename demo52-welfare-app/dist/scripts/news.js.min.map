{"version":3,"sources":["news.js"],"names":["$","_Base","jQuery","support","cors","t","window","Base","_defineProperty","site","language","navigator","browserLanguage","toLowerCase","versions","userAgent","e","wechat","match","appVersion","gecko","indexOf","qq","weibo","trident","presto","webKit","ios","android","arguments","document","iPhone","n","iPad","webApp","i","style","fontSize","getComputedStyle","getPropertyValue","o","addEventListener","setSeo","documentElement","res","log","clientWidth","title","attr","data","alert","message","toggle","toggleClass","that","this","id","getQueryString","postAjax","console","status","article","imgArrays","str_content","cat_id","children","str_thumb","show","html","news_time","capture","element","replace","append","content","name","reg","RegExp","substr","context","r","text","datas","fns","fnf","type","url","dataType","success","fail","getInfos","on","showNav"],"mappings":"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","file":"news.js","sourcesContent":["$(function () {\r\n    jQuery.support.cors = true;\r\n    let Base = window.Base || {};\r\n    Base = {\r\n        site: 'https://www.doubaner.top',\r\n        language: (navigator.browserLanguage || navigator.language).toLowerCase(),\r\n        versions: function () {\r\n            var e = navigator.userAgent, t = e.toLowerCase();\r\n            navigator.appVersion;\r\n            return {\r\n                wechat: \"micromessenger\" == t.match(/MicroMessenger/i),\r\n                qq: \"qq\" == t.match(/QQ/i),\r\n                weibo: \"weibo\" == t.match(/WeiBo/i),\r\n                trident: e.indexOf(\"Trident\") > -1,\r\n                presto: e.indexOf(\"Presto\") > -1,\r\n                webKit: e.indexOf(\"AppleWebKit\") > -1,\r\n                gecko: e.indexOf(\"Gecko\") > -1 && -1 == e.indexOf(\"KHTML\"),\r\n                mobile: !!e.match(/AppleWebKit.*Mobile.*/),\r\n                ios: !!e.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/),\r\n                android: e.indexOf(\"Android\") > -1 || e.indexOf(\"Linux\") > -1,\r\n                iPhone: e.indexOf(\"iPhone\") > -1,\r\n                iPad: e.indexOf(\"iPad\") > -1,\r\n                webApp: -1 == e.indexOf(\"Safari\")\r\n            }\r\n        }(),\r\n        fontSize: function () {\r\n            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : window, t = e.document,\r\n                i = t.documentElement, n = \"orientationchange\" in e ? \"orientationchange\" : \"resize\",\r\n                o = function () {\r\n                    var e = i.clientWidth || 375;\r\n                    e > 750 && (e = 750), i.style.fontSize = e / 7.5 + \"px\"\r\n                };\r\n            window.getComputedStyle(i, null).getPropertyValue(\"font-size\") <= \"20px\" && o(), t.addEventListener && (e.addEventListener(n, o, !1), t.addEventListener(\"DOMContentLoaded\", o, !1))\r\n        },\r\n        setSeo() {\r\n            let that = this;\r\n            that.getAjax('/seo', {}, function (res) {\r\n                console.log(res);\r\n                if (res.status == 200) {\r\n                    $(\"title\").text(res.data.title);\r\n                    $(\"meta[name='keywords']\").attr('content', res.data['keywords']);\r\n                    $(\"meta[name='description']\").attr('content', res.data['description']);\r\n                } else {\r\n                    alert(res.message);\r\n                }\r\n            })\r\n\r\n        },\r\n        showNav() {\r\n            $(\".common-header ol\").toggle();\r\n            $(\"body\").toggleClass('header-active');\r\n        },\r\n        getInfos() {\r\n            let that = this;\r\n            let id = that.getQueryString('id');\r\n            that.postAjax('/new', {\r\n                id: id\r\n            }, function (res) {\r\n                console.log(res);\r\n                if (res.status == 200) {\r\n                    let article = $('#news-body>main>article');\r\n                    let imgArrays = [];\r\n                    let content = res.data.str_content;\r\n                    article.attr('data-id', res.data.cat_id)\r\n                    article.children(\"h3\").html(res.data.str_title);\r\n                    article.children(\".icon\").attr('src', that.site + res.data.str_thumb).show();\r\n                    article.children(\".time\").html(res.data.news_time);\r\n                    content.replace(/<img [^>]*src=['\"]([^'\"]+)[^>]*>/gi, function (match, capture) {\r\n                        imgArrays.push(capture);\r\n                    });\r\n                    // console.log(imgArrays);\r\n                    if (imgArrays) {\r\n                        imgArrays.forEach(element => {\r\n                            let src = that.site + element;\r\n                            content.replace(element, src);\r\n                        });\r\n                    }\r\n                    article.append(content);\r\n                } else {\r\n                    alert(res.message);\r\n                }\r\n            });\r\n        },\r\n        getQueryString: function (name) {\r\n            var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n            var r = window.location.search.substr(1).match(reg); //获取url中\"?\"符后的字符串并正则匹配\r\n            var context = \"\";\r\n            if (r != null)\r\n                context = r[2];\r\n            reg = null;\r\n            r = null;\r\n            return context == null || context == \"\" || context == \"undefined\" ? \"\" : context;\r\n        },\r\n        setSeo() {\r\n            let that = this;\r\n            that.getAjax('/seo', {}, function (res) {\r\n                console.log(res);\r\n                if (res.status == 200) {\r\n                    $(\"title\").text(res.data.title);\r\n                    $(\"meta[name='keywords']\").attr('content', res.data['keywords']);\r\n                    $(\"meta[name='description']\").attr('content', res.data['description']);\r\n                } else {\r\n                    alert(res.message);\r\n                }\r\n            })\r\n\r\n        },\r\n        getAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"GET\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'JSON',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        postAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"POST\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'json',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        init() {\r\n            console.log('111');\r\n            let that = this;\r\n            that.getInfos();\r\n            that.fontSize();\r\n            that.setSeo();\r\n            $(\".common-header ul\").on('click', function () {\r\n                that.showNav();\r\n            });\r\n        }\r\n    }\r\n    Base.init();\r\n});"]}