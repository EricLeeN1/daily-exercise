"use strict";
$(function () {
    jQuery.support.cors = !0;
    window.Base;
    ({
        site: "https://www.doubaner.top",
        getAjax: function (t, e, a, s) {
            $.ajax({
                type: "GET",
                url: this.site + t,
                data: e,
                dataType: "JSON",
                success: a,
                fail: s
            })
        },
        code: '',
        postAjax: function (t, e, a, s) {
            $.ajax({
                type: "POST",
                url: this.site + t,
                data: e,
                dataType: "json",
                success: a,
                fail: s
            })
        },
        setSeo: function () {
            this.getAjax("/seo", {}, function (t) {
                console.log(t), 200 == t.status ? ($("title").text(t.data.title), $("meta[name='keywords']").attr("content", t.data.keywords), $("meta[name='description']").attr("content", t.data.description)) : alert(t.message)
            })
        },
        check() {
            var that = this;
            var order = that.getQueryString('out_trade_no');
            alert(order);
            var timer = setInterval(function () {
                if (!that.code) {
                    that.postAjax('wxCallback', {
                        out_trade_no: order
                    }, function (res) {
                        alert(res.code);
                        that.code = res.code;
                        if (res.code == 1) {
                            clearInterval(timer);
                            that.code = res.code;
                            window.location.href = '';
                        }
                    });
                }
            }, 1000);
        },
        getQueryString: function (t) {
            var e = new RegExp("(^|&)" + t + "=([^&]*)(&|$)", "i"),
                n = window.location.search.substr(1).match(e),
                s = "";
            return null != n && (s = n[2]), (n = e = null) == s || "" == s || "undefined" == s ? "" : s
        },
        init: function () {
            var that = this;
            that.setSeo();
            var img = that.getQueryString('img');
            $('#qrcode').attr('src', img);
            setTimeout(function () {
                that.check();
            },2000);
        }
    }).init()
});
//# sourceMappingURL=alisuccess.js.map