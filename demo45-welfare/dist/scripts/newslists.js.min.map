{"version":3,"sources":["newslists.js"],"names":["$","jQuery","support","cors","window","Base","site","pagesLength","arguments","length","undefined","that","this","type","getQueryString","page","getAjax","url","res","log","newsList","newsRightDatas","rightNewsList","status","data","Configs","newsDatas","config","count","htmlLeft","htmlRight","pagesHtml","ele","str_id","str_thumb","append","str_title","str_guide","news_time","after","forEach","metaHave","name","text","value","attr","console","index","asideTitle","crumb","Math","ceil","next","RegExp","r","alert","message","setCrumb","image","onload","onerror","datas","fns","fnf","dataType","location","search","substr","match","reg","success","fail","context","postAjax","Image","src","getInfos","hasClass","pages","init","ajax","on"],"mappings":"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","file":"newslists.js","sourcesContent":["$(function () {\r\n    jQuery.support.cors = true;\r\n    let Base = window.Base || {};\r\n    Base = {\r\n        site: 'https://www.doubaner.top',\r\n        pagesLength: 1,\r\n        page: 1,\r\n        getInfos(page = 1) {\r\n            let that = this;\r\n            let type = that.getQueryString('type');\r\n            let url = `/news/page/${page}/column/${type}`;\r\n            that.getAjax(url, {}, function (res) {\r\n                console.log(res);\r\n                if (res.status == 200) {\r\n                    let newsDatas = res.data.newsList;\r\n                    let newsRightDatas =\r\n                        res.data.rightNewsList;\r\n                    let config = res.data.Configs;\r\n                    let htmlLeft = '';\r\n                    let htmlRight = '';\r\n                    let count = res.data.count;\r\n                    let pagesHtml = '';\r\n                    if (newsDatas) {\r\n                        newsDatas.forEach(ele => {\r\n                            htmlLeft +=\r\n                                `<li>\r\n                                    <a href=\"./news.html?id=${ele.str_id}\">\r\n                                        <div class=\"img-infos\">\r\n                                            <img src=\"${that.site + ele.str_thumb}\" alt=\"\">\r\n                                        </div>\r\n                                        <div class=\"des-infos\">\r\n                                            <h3>${ele.str_title}</h3>\r\n                                            <p>${ele.str_guide}</p>\r\n                                            <span>${ele.news_time}</span>\r\n                                        </div>\r\n                                    </a>\r\n                                </li>`\r\n                        });\r\n                        $(\"#news-section>ul\").append(htmlLeft).after('<p class=\"tips\">没有更多了</p>');\r\n\r\n                    } else {\r\n                        $(\"#news-section>ul\").append('<h1>Sorry,这里还什么都没有</h1>');\r\n                    }\r\n                    if (config) {\r\n                        config.forEach(ele => {\r\n                            let metaHave = `meta[name=\"${ele.name}\"]`;\r\n                            if (ele.name == 'title') {\r\n                                $(\"title\").text(ele.value);\r\n                            } else {\r\n                                if ($(metaHave)[0]) {\r\n                                    $(metaHave).attr('content', ele.value);\r\n                                } else {\r\n                                    $(\"head\").append(`<meta name=\"${ele.name}\" content=\"${ele.value}\" />`);\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                    if (newsRightDatas) {\r\n                        newsRightDatas.forEach(ele => {\r\n                            htmlRight +=\r\n                                `<li>\r\n                                    <a href=\"./news.html?id=${ele.str_id}\">\r\n                                        <div class=\"img-infos\">\r\n                                            <img src=\"${that.site + ele.str_thumb}\" alt=\"\">\r\n                                        </div>\r\n                                        <div class=\"des-infos\">\r\n                                            <h3>${ele.str_title}</h3>\r\n                                            <p>${ele.news_time}</p>\r\n                                        </div>\r\n                                    </a>\r\n                                </li>`\r\n                        });\r\n                        $(\"#news-aside-list\").append(htmlRight);\r\n                    } else {\r\n                        $(\"#news-aside-list\").append('<h1>Sorry,这里还什么都没有</h1>');\r\n                    }\r\n                    that.pagesLength = Math.ceil(count / 8);\r\n                    for (let index = 1; index <= that.pagesLength; index++) {\r\n                        console.log(index);\r\n                        if (index == page) {\r\n                            pagesHtml += `<li class=\"active\" data-page=\"${index}\">${index}</li>`;\r\n                        } else {\r\n                            pagesHtml += `<li data-page=\"${index}\">${index}</li>`;\r\n                        }\r\n                    }\r\n                    $(\"#show-pages\").html(pagesHtml);\r\n                } else {\r\n                    alert(res.message);\r\n                }\r\n            });\r\n        },\r\n        setCrumb() {\r\n            let that = this;\r\n            let type = that.getQueryString('type');\r\n            let crumb = $(\"#crumb>span\");\r\n            let asideTitle = $(\"#aside-title\");\r\n            if (type == 9) {\r\n                crumb.text('行动新闻列表');\r\n                asideTitle.text('公益明星').next().attr('href', '/newsList.html?type=8');\r\n            }\r\n        },\r\n        getQueryString: function (name) {\r\n            var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n            var r = window.location.search.substr(1).match(reg); //获取url中\"?\"符后的字符串并正则匹配\r\n            var context = \"\";\r\n            if (r != null)\r\n                context = r[2];\r\n            reg = null;\r\n            r = null;\r\n            return context == null || context == \"\" || context == \"undefined\" ? \"\" : context;\r\n        },\r\n        imgLoad() {\r\n            let image = new Image();\r\n            image.onload = function () {\r\n                console.log('success');\r\n            },\r\n                image.onerror = function () {\r\n                    this.src = that.site + +this.src;\r\n                }\r\n        },\r\n        getAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"GET\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'JSON',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        postAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"POST\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'json',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        init() {\r\n            let that = this;\r\n            that.getInfos();\r\n            that.setCrumb();\r\n            $(\"#show-pages\").on('click', 'li', function () {\r\n                if ($(this).hasClass('active')) {\r\n                    return;\r\n                }\r\n                let pages = $(this).attr('data-page');\r\n                that.getInfos(pages);\r\n            })\r\n        }\r\n    }\r\n    Base.init();\r\n});"]}