{"version":3,"sources":["newslists.js"],"names":["$","jQuery","support","cors","window","Base","site","that","this","getQueryString","type","res","url","getAjax","status","console","log","data","newsList","newsDatas","newsRightDatas","config","htmlLeft","htmlRight","forEach","ele","str_id","str_thumb","str_title","str_guide","metaHave","append","after","value","name","attr","news_time","context","alert","message","onerror","crumb","asideTitle","ajax","text","next","dataType","success","fns","fail","fnf","r","Image","image","src","setCrumb","datas","postAjax","init","getInfos"],"mappings":"aAAAA,EAAE,WACEC,OAAOC,QAAQC,MAAO,EADZC,OAAAC,MACHH,CACHG,KAAAA,2BACJA,SAFOH,WAGHI,IAAMC,EAAAC,KAEED,EAAAA,uBAHLA,EAAAE,eAEQ,QAEPF,EAAIG,QAAOH,EAAKE,GAAAA,SAAeE,GAE/BJ,GADIK,QAAAA,IAAAA,GACkB,KAAjBC,EAALC,OAAsB,CAClBC,IAAQC,EAARL,EAAAM,KAAAC,SACQJ,EACAK,EAAAA,KAAAA,cACAC,EAAAA,EAAAA,KACAT,QACAU,EAASV,GACTW,EAAW,GACXC,GACAJ,EAAJK,QAAe,SAAAC,GACXN,GAAAA,qEAAAM,EAAAC,OAAAP,+HAiBGZ,EAAAD,KAAAmB,EAAAE,WAjBHR,+KAoBQM,EAAAG,UApBRT,yDAqBeM,EAAAI,UArBfV,2DAsBQW,EAAAA,UAtBRX,6IA2BYnB,EAAAA,oBAAA+B,OAAiBT,GAAjBU,MAAgCC,8BAGnCjC,EAAA,oBAAA+B,OAAA,2BAERV,GACJA,EAAAG,QAAA,SAAAC,GACGL,IAAAA,EAAAA,cAAgBK,EAAAS,KAAhBd,KACeI,SAAfJ,EAAAA,KACIG,EAAAA,SAAAA,KAAAA,EAAAA,OAaFvB,EAAA8B,GAAoBC,GACnB/B,EAAA8B,GAAAK,KAAA,UAAAV,EAAAQ,OAENjC,EAAA,QAAA+B,OAAA,eAAAN,EAAAS,KAAA,cAAAT,EAAAQ,MAAA,UApEVb,GAAAA,EA0EQI,QAAA,SAAAC,GACPF,GAAAA,qEAEAE,EAAAC,OAFA,+HAIenB,EAAAD,KAAAmB,EAAAE,WAJf,+KAOCF,EAAAG,UAPD,yDA3EDH,EAAAW,UA2EC,0IAYIC,EAAU,oBAAdN,OAAAR,IAGAvB,EAAA,oBAAA+B,OAAA,gCA1FDO,MAAA3B,EAAA4B,YAiGSxB,SAnGTb,WAoGM,IAEGQ,EADE8B,KACSjC,eAAa,QAJhCkC,EAAAzC,EAAA,eAhGD0C,EAAA1C,EAAA,gBAAA,GAAAU,IAwGGiC,EAAKC,KAAA,UACHlC,EADGkC,KAAA,QAAAC,OAAAV,KAAA,OAAA,2BAIHW,eAAAA,SAJGZ,GAKHa,IAAAA,EAAAA,IAASC,OALN,QAAAd,EAAA,gBAAA,KAMHe,EAAAA,OAAMC,SAAAA,OAAAA,OAAAA,GAAAA,MAAAA,GANVb,EAAA,GAYIzB,OApHL,MAAAuC,IAAAd,EAAAc,EAAA,KAmHKzC,EADJV,EAAA,OAEIY,GAFG,IAAAyB,GAAA,aAAAA,EAAA,GAAAA,GAIHS,QAxHL5C,WAyHK6C,IAAAA,EAAAA,IALGK,MAMHH,EAAAA,OAAMC,WANVnC,QAAAC,IAAA,YAlHDqC,EAAAb,QA2HI,WACKxB,KAAIsC,IAAZ/C,KAAAD,OAAAE,KAAA8C,MAGA/C,QAjIDL,SAiICK,EAAKgD,EAALP,EAAAE,GACHlD,EAAA2C,KAAA,CAhILjC,KAAA,MAkIAE,IAAAJ,KAAAF,KAAAM,EArIJK,KAAAuC,EA+GgBV,SAAU,OACVC,QAASC,EACTC,KAAMC,KAGdO,SAnHGvD,SAmHMU,EAAK4C,EAAOR,EAAKE,GACtBlD,EAAE2C,KAAK,CACHjC,KAAM,OACNE,IAAKJ,KAAKF,KAAOM,EACjBK,KAAMuC,EACNV,SAAU,OACVC,QAASC,EACTC,KAAMC,KAGdQ,KA7HGxD,WA8HCa,QAAQC,IAAI,OACDR,KACNmD,WADMnD,KAEN+C,cAGRG","file":"newslists.js","sourcesContent":["$(function () {\r\n    jQuery.support.cors = true;\r\n    let Base = window.Base || {};\r\n    Base = {\r\n        site: 'https://www.doubaner.top',\r\n        getInfos() {\r\n            let that = this;\r\n            let type = that.getQueryString('type');\r\n            let url = `/news/page/1/column/${type}`;\r\n            that.getAjax(url, {}, function (res) {\r\n                console.log(res);\r\n                if (res.status == 200) {\r\n                    let newsDatas = res.data.newsList;\r\n                    let newsRightDatas =\r\n                        res.data.rightNewsList;\r\n                    let config = res.data.Configs;\r\n                    let htmlLeft = '';\r\n                    let htmlRight = '';\r\n                    if (newsDatas) {\r\n                        newsDatas.forEach(ele => {\r\n                            htmlLeft +=\r\n                                `<li>\r\n                                    <a href=\"./news.html?id=${ele.str_id}\">\r\n                                        <div class=\"img-infos\">\r\n                                            <img src=\"${that.site+ele.str_thumb}\" alt=\"\">\r\n                                        </div>\r\n                                        <div class=\"des-infos\">\r\n                                            <h3>${ele.str_title}</h3>\r\n                                            <p>${ele.str_guide}</p>\r\n                                            <span>${ele.news_time}</span>\r\n                                        </div>\r\n                                    </a>\r\n                                </li>`\r\n                        });\r\n                        $(\"#news-section>ul\").append(htmlLeft).after('<p class=\"tips\">没有更多了</p>');\r\n\r\n                    } else {\r\n                        $(\"#news-section>ul\").append('<h1>Sorry,这里还什么都没有</h1>');\r\n                    }\r\n                    if (config) {\r\n                        config.forEach(ele => {\r\n                            let metaHave = `meta[name=\"${ele.name}\"]`;\r\n                            if (ele.name=='title') {\r\n                                $(\"title\").text(ele.value);\r\n                            } else {\r\n                                if ($(metaHave)[0]) {\r\n                                    $(metaHave).attr('content', ele.value);\r\n                                } else {\r\n                                    $(\"head\").append(`<meta name=\"${ele.name}\" content=\"${ele.value}\" />`);\r\n                                }\r\n                            } \r\n                        });\r\n                    }\r\n                    if (newsRightDatas) {\r\n                        newsRightDatas.forEach(ele => {\r\n                            htmlRight +=\r\n                                `<li>\r\n                                    <a href=\"./news.html?id=${ele.str_id}\">\r\n                                        <div class=\"img-infos\">\r\n                                            <img src=\"${that.site+ele.str_thumb}\" alt=\"\">\r\n                                        </div>\r\n                                        <div class=\"des-infos\">\r\n                                            <h3>${ele.str_title}</h3>\r\n                                            <p>${ele.news_time}</p>\r\n                                        </div>\r\n                                    </a>\r\n                                </li>`\r\n                        });\r\n                        $(\"#news-aside-list\").append(htmlRight);\r\n                    } else {\r\n                        $(\"#news-aside-list\").append('<h1>Sorry,这里还什么都没有</h1>');\r\n                    }\r\n                } else {\r\n                    alert(res.message);\r\n                }\r\n            });\r\n        },\r\n        setCrumb() {\r\n            let that = this;\r\n            let type = that.getQueryString('type');\r\n            let crumb = $(\"#crumb>span\");\r\n            let asideTitle = $(\"#aside-title\");\r\n            if (type == 9) {\r\n                crumb.text('行动新闻列表');\r\n                asideTitle.text('公益明星').next().attr('href', '/newsList.html?type=8');\r\n            }\r\n        },\r\n        getQueryString: function (name) {\r\n            var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n            var r = window.location.search.substr(1).match(reg); //获取url中\"?\"符后的字符串并正则匹配\r\n            var context = \"\";\r\n            if (r != null)\r\n                context = r[2];\r\n            reg = null;\r\n            r = null;\r\n            return context == null || context == \"\" || context == \"undefined\" ? \"\" : context;\r\n        },\r\n        imgLoad() {\r\n            let image = new Image();\r\n            image.onload = function () {\r\n                    console.log('success');\r\n                },\r\n                image.onerror = function () {\r\n                    this.src = that.site + +this.src;\r\n                }\r\n        },\r\n        getAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"GET\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'JSON',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        postAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"POST\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'json',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        init() {\r\n            console.log('111');\r\n            let that = this;\r\n            that.getInfos();\r\n            that.setCrumb();\r\n        }\r\n    }\r\n    Base.init();\r\n});"]}