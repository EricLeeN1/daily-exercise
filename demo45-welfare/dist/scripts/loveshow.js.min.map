{"version":3,"sources":["loveshow.js"],"names":["$","jQuery","support","cors","window","Base","site","pagesLength","arguments","length","undefined","that","this","url","page","res","console","log","status","count","data","datas","pagesHtml","showitem","title","ele","file","html","Math","ceil","index","alert","message","getQueryString","name","r","location","substr","context","search","match","reg","imgLoad","image","Image","onerror","src","dataType","success","fns","fail","fnf","text","attr","showList","setSeo","pages","init"],"mappings":"aAAAA,EAAE,WACEC,OAAOC,QAAQC,MAAO,EADZC,OAAAC,MACHH,CACHG,KAAAA,2BACJA,YAAO,EACHC,KAAM,EACNC,SAJGL,WAEA,IAEHK,EAFG,EAAAC,UAAAC,aAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAA,EAAAG,EAAAC,KAAAC,EAAAA,cAAAC,EAIgBH,EAAVG,QAAUD,EAAA,GAAA,SAAAE,GACXJ,GAGAK,QAAQC,IAAIF,GAHhB,KAAIJ,EAAOO,OAAX,CACIL,IAAAA,EAAAA,EAAAA,KAAoBC,KACxBK,EAAAJ,EAAsBK,KAAAD,MACVF,EAAR,GACIF,GAAmB,EAAfG,EAAJT,OAAmB,CACfY,IAAAA,EAAYD,GACZD,EAAAA,QAAYC,SAAAA,GACZE,GAAAA,2EAEIC,EAAJC,MAFAF,oDAGcX,EAAAL,KAAOmB,EAAAC,MAHrBJ,gBAGqBX,EAAAL,KAAAmB,EAAAC,MAHrBJ,qDAIIC,EAAAA,KAJJD,6EAcAtB,EAAE,cAAc2B,KAAKJ,QAEzBZ,EAAKJ,cAAcqB,KAAKC,qBAEpBb,EAAAA,YAAYc,KAAZD,KAAAV,EAAA,GACA,IAAA,IAAIW,EAAShB,EAAAA,GAAMH,EAAAJ,YAAAuB,IACfR,QAAAA,IAAAA,GAEAA,GAHJQ,GAEOhB,EACHQ,iCAAAQ,EAAAR,KAAAQ,EAAAR,QAEPA,kBAAAQ,EAAA,KAAAA,EAAA,QAGDC,EAAAA,eAAAJ,KAAAL,QAhCRS,MAAAhB,EAAAiB,YAqCAC,eAAU,SAAWC,GACrB,IAAIC,EAAI/B,IAAAA,OAAOgC,QAAgBC,EAAO,gBAAe,KACjDC,EAAAA,OAAUF,SAAdG,OAAAF,OAAA,GAAAG,MAAAC,GACIN,EAAJ,GAMJO,OAJU,MAAND,IACIH,EAAJH,EAAA,KAlDDA,EAmDCM,EAAA,OAnDDH,GAqDO,IAAAA,GAAA,aAAAA,EAAA,GAAAA,GAENK,QAzDDzC,WA0DKc,IAAAA,EAAQC,IAAI2B,MACfD,EACGA,OAAME,WACF7B,QAAAC,IAAWN,YA3DpBgC,EAAAE,QAAA,WAAAjC,KAAAkC,IAAAnC,KA8DKE,OA9DLD,KAAAkC,MAiEKjC,QAnELX,SAmEKW,EAAKQ,EAAKf,EAAOO,GACjBO,EAAAA,KAAAA,CACA2B,KAAAA,MACAC,IAAAA,KAASC,KALNpC,EAMHqC,KAAMC,EANVJ,SAAA,OA/DDC,QAAAC,EAAAC,KAAAC,KA2EKtC,SA7ELX,SA6EKW,EAAKQ,EAAKf,EAAOO,GACjBO,EAAAA,KAAAA,CACA2B,KAAAA,OACAC,IAAAA,KAASC,KALNpC,EAMHqC,KAAMC,EANVJ,SAAA,OAzEDC,QAAAC,EAAAC,KAAAC,KAqFKnC,OAvFLd,WAwFSa,KACAf,QAAE,OAASoD,GAAKrC,SAASS,GACzBxB,QAAEiB,IAAAF,GACA,KAAFf,EAAEkB,QAHNlB,EAAA,SAIOoD,KAAArC,EAAAK,KAAAI,OACHO,EAAAA,yBAAAsB,KAAA,UAAAtC,EAAAK,KAAA,UACHpB,EAAA,4BAAAqD,KAAA,UAAAtC,EAAAK,KAAA,cA5FNW,MAAAhB,EAAAiB,YAoGChC,KAtGDE,WAuGK,IAAAS,EAAMC,KACFD,EAAA2C,WACH3C,EAAA4C,SACDvD,EAAA,eAAYA,GAAE,QAAW,KAAA,WACzBW,IAAAA,EAAK2C,MAAAA,SAAL,UAAA3C,CAzGZ,IAAA6C,EAAAxD,EAAAY,MAAAyC,KAAA,aA6GA1C,EAAA2C,SAAAE,SAAKC","file":"loveshow.js","sourcesContent":["$(function () {\r\n    jQuery.support.cors = true;\r\n    let Base = window.Base || {};\r\n    Base = {\r\n        site: 'https://www.doubaner.top',\r\n        pagesLength: 1,\r\n        page: 1,\r\n        showList(page = 1) {\r\n            let that = this;\r\n            let url = `/publicity/${page}`;\r\n            that.getAjax(url, {}, function (res) {\r\n                console.log(res);\r\n                if (res.status == 200) {\r\n                    let datas = res.data.list;\r\n                    let count = res.data.count;\r\n                    let pagesHtml = '';\r\n                    if (datas.length > 0) {\r\n                        let showitem = '';\r\n                        datas.forEach(ele => {\r\n                            showitem += `\r\n                            <li>\r\n                                <h3>${ele.title}</h3>\r\n                                <a href=\"${that.site + ele.file}\" download=\"${that.site + ele.file}\">立即下载</a>\r\n                                <span>${ele.time}</span>\r\n                            </li>\r\n                            `;\r\n                        });\r\n                        $(\"#show-list\").html(showitem);\r\n                    } else {\r\n                        $(\"#show-list\").html('<h3>这里还什么都没有</h3>');\r\n                    }\r\n                    that.pagesLength = Math.ceil(count / 8);\r\n                    for (let index = 1; index <= that.pagesLength; index++) {\r\n                        console.log(index);\r\n                        if (index == page) {\r\n                            pagesHtml += `<li class=\"active\" data-page=\"${index}\">${index}</li>`;\r\n                        } else {\r\n                            pagesHtml += `<li data-page=\"${index}\">${index}</li>`;\r\n                        }\r\n                    }\r\n                    $(\"#show-pages\").html(pagesHtml);\r\n                } else {\r\n                    alert(res.message);\r\n                }\r\n            });\r\n        },\r\n        getQueryString: function (name) {\r\n            var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n            var r = window.location.search.substr(1).match(reg); //获取url中\"?\"符后的字符串并正则匹配\r\n            var context = \"\";\r\n            if (r != null)\r\n                context = r[2];\r\n            reg = null;\r\n            r = null;\r\n            return context == null || context == \"\" || context == \"undefined\" ? \"\" : context;\r\n        },\r\n        imgLoad() {\r\n            let image = new Image();\r\n            image.onload = function () {\r\n                console.log('success');\r\n            },\r\n                image.onerror = function () {\r\n                    this.src = that.site + +this.src;\r\n                }\r\n        },\r\n        getAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"GET\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'JSON',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        postAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"POST\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'json',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        setSeo() {\r\n            let that = this;\r\n            that.getAjax('/seo', {}, function (res) {\r\n                console.log(res);\r\n                if (res.status == 200) {\r\n                    $(\"title\").text(res.data.title);\r\n                    $(\"meta[name='keywords']\").attr('content', res.data['keywords']);\r\n                    $(\"meta[name='description']\").attr('content', res.data['description']);\r\n                } else {\r\n                    alert(res.message);\r\n                }\r\n            })\r\n\r\n        },\r\n        init() {\r\n            let that = this;\r\n            that.showList();\r\n            that.setSeo();\r\n            $(\"#show-pages\").on('click', 'li', function () {\r\n                if ($(this).hasClass('active')) {\r\n                    return;\r\n                }\r\n                let pages = $(this).attr('data-page');\r\n                that.showList(pages);\r\n            })\r\n        }\r\n    }\r\n    Base.init();\r\n});"]}