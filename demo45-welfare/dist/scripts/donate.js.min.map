{"version":3,"sources":["donate.js"],"names":["$","jQuery","support","cors","window","Base","site","check","type","payValue","this","checkForms","that","params","regPhone","val","regEmail","invoicing","username","sex","phone","email","total_fee","invoice","address","next","text","test","TaxID","payOrder","e","way","attr","radioValue","postAjax","res","value","blurCheck","checkType","toggleForms","optionCheck","changePayValue","ele","addClass","siblings","removeClass","getCheck","show","hide","args","parent","getQueryString","name","RegExp","location","search","substr","match","reg","context","r","imgLoad","Image","onload","image","onerror","src","fns","fnf","ajax","url","data","datas","success","fail","on","_this"],"mappings":"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","file":"donate.js","sourcesContent":["$(function () {\r\n    jQuery.support.cors = true;\r\n    let Base = window.Base || {};\r\n    Base = {\r\n        site: 'https://www.doubaner.top',\r\n        check: false,\r\n        payValue: 197,\r\n        checkForms(type) {\r\n            let that = this;\r\n            let params = {};\r\n            let regPhone = /^1[3-8]\\d{9}$/;\r\n            let regEmail = /^([0-9A-Za-z\\-_\\.]+)@([0-9a-z]+\\.[a-z]{2,3}(\\.[a-z]{2})?)$/g;;\r\n            let invoicing = $(\"input[name=receipt]:checked\").val();\r\n            params.username = $(\"#name\").val();\r\n            params.sex = $(\"input[name=appellation]:checked\").val();\r\n            params.phone = $(\"#phone\").val();\r\n            params.email = $(\"#email\").val();\r\n            params.total_fee = that.payValue ? that.payValue : $(\"pay-value\").val();\r\n            params.invoicing = invoicing ? $(\"#select-choice\").val() : 0;\r\n            params.invoice = $(\"#organ-name\").val();\r\n            params.TaxID = $(\"#organ-name\").val();\r\n            params.address = $(\"#address\").val();\r\n\r\n            if (type == 1) {// 全部都要，全部校验\r\n                if (!params.username) {\r\n                    $(\"#name\").next('span').text(\"您还没有填写名字呢\");\r\n                    return;\r\n                } else {\r\n                    $(\"#name\").next('span').text(\"\");\r\n                }\r\n                if (!regPhone.test(params.phone)) {\r\n                    $(\"#phone\").next('span').text(\"手机号码格式不对\");\r\n                    return;\r\n                } else {\r\n                    $(\"#phone\").next('span').text(\"\");\r\n                }\r\n                if (!regEmail.test(params.email)) {\r\n                    $(\"#email\").next('span').text(\"电子邮箱格式不对\");\r\n                    return;\r\n                } else {\r\n                    $(\"#email\").next('span').text(\"\");\r\n                }\r\n                if (!params.address) {\r\n                    $(\"#address\").next('span').text(\"邮寄地址不能为空\");\r\n                    return;\r\n                } else {\r\n                    $(\"#address\").next('span').text(\"\");\r\n                }\r\n                if (invoicing && !params.invoice) {\r\n                    $(\"#organ-name\").next('span').text(\"请输入发票抬头\");\r\n                    return;\r\n                } else {\r\n                    $(\"#organ-name\").next('span').text(\"\");\r\n                }\r\n                if (invoicing && !params.TaxID) {\r\n                    $(\"#taxid\").next('span').text(\"请输入税号\");\r\n                    return;\r\n                } else {\r\n                    $(\"#taxid\").next('span').text(\"\");\r\n                };\r\n                that.check = true;\r\n                return params;\r\n            } else if (type == 2) {//不要发票,不用校验税号与发票抬头\r\n                if (!params.username) {\r\n                    $(\"#name\").next('span').text(\"您还没有填写名字呢\");\r\n                    return;\r\n                } else {\r\n                    $(\"#name\").next('span').text(\"\");\r\n                }\r\n                if (!regPhone.test(params.phone)) {\r\n                    $(\"#phone\").next('span').text(\"手机号码格式不对\");\r\n                    return;\r\n                } else {\r\n                    $(\"#phone\").next('span').text(\"\");\r\n                }\r\n                if (!regEmail.test(params.email)) {\r\n                    $(\"#email\").next('span').text(\"电子邮箱格式不对\");\r\n                    return;\r\n                } else {\r\n                    $(\"#email\").next('span').text(\"\");\r\n                }\r\n                if (!params.address) {\r\n                    $(\"#address\").next('span').text(\"邮寄地址不能为空\");\r\n                    return;\r\n                } else {\r\n                    $(\"#address\").next('span').text(\"\");\r\n                }\r\n                that.check = true;\r\n                return params;\r\n            } else {//小于100只校验名字\r\n                if (!params.username) {\r\n                    $(\"#name\").next('span').text(\"您还没有填写名字呢\");\r\n                    return;\r\n                } else {\r\n                    $(\"#name\").next('span').text(\"\");\r\n                }\r\n                that.check = true;\r\n                return params;\r\n            }\r\n        },\r\n        payOrder(e) {\r\n            let that = this;\r\n            let params = null;\r\n            let payValue = that.payValue;\r\n            let way = e.attr('data-type');\r\n            let radioValue = $(\"#form-group input[name=receipt]\").val();\r\n            if (payValue > 100) {\r\n                if (radioValue) {\r\n                    params = that.checkForms(1);\r\n                } else {\r\n                    params = that.checkForms(2);\r\n                }\r\n            } else {\r\n                params = that.checkForms(0);\r\n            }\r\n            if (that.check) {\r\n                params.way = way;\r\n                that.postAjax('/pay', params, function (res) {\r\n                    that.check = false;\r\n                })\r\n            }\r\n        },\r\n        blurCheck(e) {\r\n            let that = this;\r\n            let regPhone = /^1[3-8]\\d{9}$/;\r\n            let regEmail = /^([0-9A-Za-z\\-_\\.]+)@([0-9a-z]+\\.[a-z]{2,3}(\\.[a-z]{2})?)$/g;\r\n            let value = e.val();\r\n            let checkType = e.attr('data-check');\r\n            let optionCheck = $(\"input[name=receipt]:checked\").val();\r\n            switch (checkType) {\r\n                case \"name\":\r\n                    if (!value) {\r\n                        $(\"#name\").next('span').text(\"您还没有填写名字呢\");\r\n                    } else {\r\n                        $(\"#name\").next('span').text(\"\");\r\n                    }\r\n                    break;\r\n                case \"pay\":\r\n                    if (value < 100) {\r\n                        that.toggleForms(false);\r\n                        that.payValue = value;\r\n                    } else {\r\n                        that.toggleForms(true);\r\n                        that.payValue = value;\r\n                    }\r\n                    break;\r\n                case \"phone\":\r\n                    if (!regPhone.test(value)) {\r\n                        $(\"#phone\").next('span').text(\"手机号码格式不对\");\r\n                    } else {\r\n                        $(\"#phone\").next('span').text(\"\");\r\n                    }\r\n                    break;\r\n                case \"email\":\r\n                    if (!regEmail.test(value)) {\r\n                        $(\"#email\").next('span').text(\"电子邮箱格式不对\");\r\n                    } else {\r\n                        $(\"#email\").next('span').text(\"\");\r\n                    }\r\n                    break;\r\n                case \"address\":\r\n                    if (!value) {\r\n                        $(\"#address\").next('span').text(\"邮寄地址不能为空\");\r\n                    } else {\r\n                        $(\"#address\").next('span').text(\"\");\r\n                    }\r\n                    break;\r\n                case \"organ-name\":\r\n                    if (optionCheck && !value) {\r\n                        $(\"#organ-name\").next('span').text(\"请输入发票抬头1\");\r\n                    } else {\r\n                        $(\"#organ-name\").next('span').text(\"\");\r\n                    }\r\n                    break;\r\n                case \"taxid\":\r\n                    if (optionCheck && !value) {\r\n                        $(\"#taxid\").next('span').text(\"请输入税号\");\r\n                    } else {\r\n                        $(\"#taxid\").next('span').text(\"\");\r\n                    }\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        },\r\n        changePayValue(ele) {\r\n            let that = this;\r\n            let value = ele.attr('data-value');\r\n            ele.addClass('active').siblings().removeClass('active');\r\n            if (value) {\r\n                that.payValue = value;\r\n            }\r\n            if (ele.index() != \"3\") {\r\n                $(\"#pay-value\").val(\"\");\r\n                that.toggleForms(true);\r\n            }\r\n        },\r\n        getCheck(ele) {\r\n            let that = this;\r\n            if (ele.val()) {\r\n                $(\"#form-group .receipt-choice\").show();\r\n            } else {\r\n                $(\"#form-group .receipt-choice\").hide();\r\n            }\r\n        },\r\n        toggleForms(args) {\r\n            if (args) {\r\n                $(\"#form-group input[data-check]:not([data-check='name']),.receipt-radio\").parent().show();\r\n                $(\"#form-group :radio[name='appellation'] \").parent().parent().show();\r\n            } else {\r\n                $(\"#form-group input[data-check]:not([data-check='name']),.receipt-radio\").parent().hide();\r\n                $(\"#form-group :radio[name='appellation'] \").parent().parent().hide();\r\n            }\r\n        },\r\n        getQueryString: function (name) {\r\n            var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n            var r = window.location.search.substr(1).match(reg); //获取url中\"?\"符后的字符串并正则匹配\r\n            var context = \"\";\r\n            if (r != null)\r\n                context = r[2];\r\n            reg = null;\r\n            r = null;\r\n            return context == null || context == \"\" || context == \"undefined\" ? \"\" : context;\r\n        },\r\n        imgLoad() {\r\n            let image = new Image();\r\n            image.onload = function () {\r\n            };\r\n            image.onerror = function () {\r\n                this.src = that.site + +this.src;\r\n            }\r\n        },\r\n        getAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"GET\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'JSON',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        postAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"POST\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'json',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        init() {\r\n            let that = this;\r\n            $(\"#pay-methods>img\").on('click', function () {\r\n                let _this = $(this);\r\n                that.payOrder(_this);\r\n            });\r\n            $(\"#pay-methods-list>li\").on('click', function () {\r\n                let _this = $(this);\r\n                that.changePayValue(_this);\r\n            });\r\n            $(\"#form-group input[data-check],#pay-value\").on('blur', function () {\r\n                let _this = $(this);\r\n                that.blurCheck(_this);\r\n            });\r\n            $(\"#form-group input[name=receipt]\").on('change', function () {\r\n                let _this = $(this);\r\n                that.getCheck(_this);\r\n            });\r\n        }\r\n    }\r\n    Base.init();\r\n});"]}