{"version":3,"sources":["donate.js"],"names":["$","jQuery","support","cors","window","Base","site","check","payValue","type","modalShow","this","checkForms","that","params","regPhone","val","regEmail","invoicing","username","sex","phone","email","total_fee","invoice","address","next","text","test","TaxID","modalHide","hide","payOrder","e","way","attr","radioValue","console","log","submit","blurCheck","value","checkType","toggleForms","optionCheck","changePayValue","ele","addClass","siblings","removeClass","getCheck","show","args","parent","getQueryString","name","RegExp","location","search","substr","match","reg","context","r","imgLoad","Image","onload","image","onerror","src","fns","fnf","ajax","url","data","datas","success","fail","getAjax","res","status","title","message","init","setSeo","on","_this"],"mappings":"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","file":"donate.js","sourcesContent":["$(function () {\r\n    jQuery.support.cors = true;\r\n    let Base = window.Base || {};\r\n    Base = {\r\n        site: 'https://www.doubaner.top',\r\n        check: false,\r\n        payValue: 197,\r\n        modalShow: false,\r\n        checkForms(type) {\r\n            let that = this;\r\n            let params = {};\r\n            let regPhone = /^1[3-8]\\d{9}$/;\r\n            let regEmail = /^([0-9A-Za-z\\-_\\.]+)@([0-9a-z]+\\.[a-z]{2,3}(\\.[a-z]{2})?)$/g;;\r\n            let invoicing = $(\"input[name=invoicing]:checked\").val();\r\n            params.username = $(\"#username\").val();\r\n            params.sex = $(\"input[name=sex]:checked\").val();\r\n            params.phone = $(\"#phone\").val();\r\n            params.email = $(\"#email\").val();\r\n            params.total_fee = that.payValue ? that.payValue : $(\"pay-value\").val();\r\n            params.invoicing = invoicing ? $(\"#select-choice\").val() : 0;\r\n            params.invoice = $(\"#organ-name\").val();\r\n            params.TaxID = $(\"#organ-name\").val();\r\n            params.address = $(\"#address\").val();\r\n\r\n            if (type == 1) {// 全部都要，全部校验\r\n                if (!params.username) {\r\n                    $(\"#name\").next('span').text(\"您还没有填写名字呢\");\r\n                    return;\r\n                } else {\r\n                    $(\"#name\").next('span').text(\"\");\r\n                }\r\n                if (!regPhone.test(params.phone)) {\r\n                    $(\"#phone\").next('span').text(\"手机号码格式不对\");\r\n                    return;\r\n                } else {\r\n                    $(\"#phone\").next('span').text(\"\");\r\n                }\r\n                if (!regEmail.test(params.email)) {\r\n                    $(\"#email\").next('span').text(\"电子邮箱格式不对\");\r\n                    return;\r\n                } else {\r\n                    $(\"#email\").next('span').text(\"\");\r\n                }\r\n                if (!params.address) {\r\n                    $(\"#address\").next('span').text(\"邮寄地址不能为空\");\r\n                    return;\r\n                } else {\r\n                    $(\"#address\").next('span').text(\"\");\r\n                }\r\n                if (invoicing && !params.invoice) {\r\n                    $(\"#organ-name\").next('span').text(\"请输入发票抬头\");\r\n                    return;\r\n                } else {\r\n                    $(\"#organ-name\").next('span').text(\"\");\r\n                }\r\n                if (invoicing && !params.TaxID) {\r\n                    $(\"#taxid\").next('span').text(\"请输入税号\");\r\n                    return;\r\n                } else {\r\n                    $(\"#taxid\").next('span').text(\"\");\r\n                };\r\n                that.check = true;\r\n                return params;\r\n            } else if (type == 2) {//不要发票,不用校验税号与发票抬头\r\n                if (!params.username) {\r\n                    $(\"#name\").next('span').text(\"您还没有填写名字呢\");\r\n                    return;\r\n                } else {\r\n                    $(\"#name\").next('span').text(\"\");\r\n                }\r\n                if (!regPhone.test(params.phone)) {\r\n                    $(\"#phone\").next('span').text(\"手机号码格式不对\");\r\n                    return;\r\n                } else {\r\n                    $(\"#phone\").next('span').text(\"\");\r\n                }\r\n                if (!regEmail.test(params.email)) {\r\n                    $(\"#email\").next('span').text(\"电子邮箱格式不对\");\r\n                    return;\r\n                } else {\r\n                    $(\"#email\").next('span').text(\"\");\r\n                }\r\n                if (!params.address) {\r\n                    $(\"#address\").next('span').text(\"邮寄地址不能为空\");\r\n                    return;\r\n                } else {\r\n                    $(\"#address\").next('span').text(\"\");\r\n                }\r\n                that.check = true;\r\n                return params;\r\n            } else {//小于100只校验名字\r\n                if (!params.username) {\r\n                    $(\"#name\").next('span').text(\"您还没有填写名字呢\");\r\n                    return;\r\n                } else {\r\n                    $(\"#name\").next('span').text(\"\");\r\n                }\r\n                that.check = true;\r\n                return params;\r\n            }\r\n        },\r\n        modalHide() {\r\n            $('#qrcode-modal').hide();\r\n            this.modalShow = false;\r\n        },\r\n        payOrder(e) {\r\n            let that = this;\r\n            let params = null;\r\n            let payValue = that.payValue;\r\n            let way = e.attr('data-type');\r\n            let radioValue = $(\"#form-group input[name=receipt]\").val();\r\n            if (payValue > 100) {\r\n                if (radioValue) {\r\n                    params = that.checkForms(1);\r\n                } else {\r\n                    params = that.checkForms(2);\r\n                }\r\n            } else {\r\n                params = that.checkForms(0);\r\n            }\r\n            if (that.check) {\r\n                params.way = way;\r\n                console.log(params);\r\n                // that.postAjax('/pay', params, function (res) {\r\n                //     that.check = false;\r\n                //     $(\"body\").html(res)\r\n                //     console.log(res);\r\n                //     if (params.way == 2) {\r\n                //         $('#qrcode-modal').show();\r\n                //         that.modalShow = true;\r\n                //     } else if (params.way == 1) {\r\n                //         // window.location.href = \"./alisuccess.html\";\r\n                //     }\r\n                // });\r\n                $(\"#pay-form\").submit();\r\n            }\r\n        },\r\n        blurCheck(e) {\r\n            let that = this;\r\n            let regPhone = /^1[3-8]\\d{9}$/;\r\n            let regEmail = /^([0-9A-Za-z\\-_\\.]+)@([0-9a-z]+\\.[a-z]{2,3}(\\.[a-z]{2})?)$/g;\r\n            let value = e.val();\r\n            let checkType = e.attr('data-check');\r\n            let optionCheck = $(\"input[name=receipt]:checked\").val();\r\n            switch (checkType) {\r\n                case \"name\":\r\n                    if (!value) {\r\n                        $(\"#name\").next('span').text(\"您还没有填写名字呢\");\r\n                    } else {\r\n                        $(\"#name\").next('span').text(\"\");\r\n                    }\r\n                    break;\r\n                case \"pay\":\r\n                    if (value < 100) {\r\n                        that.toggleForms(false);\r\n                        that.payValue = value;\r\n                    } else {\r\n                        that.toggleForms(true);\r\n                        that.payValue = value;\r\n                    }\r\n                    break;\r\n                case \"phone\":\r\n                    if (!regPhone.test(value)) {\r\n                        $(\"#phone\").next('span').text(\"手机号码格式不对\");\r\n                    } else {\r\n                        $(\"#phone\").next('span').text(\"\");\r\n                    }\r\n                    break;\r\n                case \"email\":\r\n                    if (!regEmail.test(value)) {\r\n                        $(\"#email\").next('span').text(\"电子邮箱格式不对\");\r\n                    } else {\r\n                        $(\"#email\").next('span').text(\"\");\r\n                    }\r\n                    break;\r\n                case \"address\":\r\n                    if (!value) {\r\n                        $(\"#address\").next('span').text(\"邮寄地址不能为空\");\r\n                    } else {\r\n                        $(\"#address\").next('span').text(\"\");\r\n                    }\r\n                    break;\r\n                case \"organ-name\":\r\n                    if (optionCheck && !value) {\r\n                        $(\"#organ-name\").next('span').text(\"请输入发票抬头1\");\r\n                    } else {\r\n                        $(\"#organ-name\").next('span').text(\"\");\r\n                    }\r\n                    break;\r\n                case \"taxid\":\r\n                    if (optionCheck && !value) {\r\n                        $(\"#taxid\").next('span').text(\"请输入税号\");\r\n                    } else {\r\n                        $(\"#taxid\").next('span').text(\"\");\r\n                    }\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        },\r\n        changePayValue(ele) {\r\n            let that = this;\r\n            let value = ele.attr('data-value');\r\n            ele.addClass('active').siblings().removeClass('active');\r\n            if (value) {\r\n                that.payValue = value;\r\n            }\r\n            if (ele.index() != \"3\") {\r\n                $(\"#pay-value\").val(\"\");\r\n                that.toggleForms(true);\r\n            }\r\n        },\r\n        getCheck(ele) {\r\n            let that = this;\r\n            if (ele.val()) {\r\n                $(\"#form-group .receipt-choice\").show();\r\n            } else {\r\n                $(\"#form-group .receipt-choice\").hide();\r\n            }\r\n        },\r\n        toggleForms(args) {\r\n            if (args) {\r\n                $(\"#form-group input[data-check]:not([data-check='name']),.receipt-radio\").parent().show();\r\n                $(\"#form-group :radio[name='appellation'] \").parent().parent().show();\r\n            } else {\r\n                $(\"#form-group input[data-check]:not([data-check='name']),.receipt-radio\").parent().hide();\r\n                $(\"#form-group :radio[name='appellation'] \").parent().parent().hide();\r\n            }\r\n        },\r\n        getQueryString: function (name) {\r\n            var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n            var r = window.location.search.substr(1).match(reg); //获取url中\"?\"符后的字符串并正则匹配\r\n            var context = \"\";\r\n            if (r != null)\r\n                context = r[2];\r\n            reg = null;\r\n            r = null;\r\n            return context == null || context == \"\" || context == \"undefined\" ? \"\" : context;\r\n        },\r\n        imgLoad() {\r\n            let image = new Image();\r\n            image.onload = function () {\r\n            };\r\n            image.onerror = function () {\r\n                this.src = that.site + +this.src;\r\n            }\r\n        },\r\n        getAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"GET\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'JSON',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        postAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"POST\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'json',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        setSeo() {\r\n            let that = this;\r\n            that.getAjax('/seo', {}, function (res) {\r\n                console.log(res);\r\n                if (res.status == 200) {\r\n                    $(\"title\").text(res.data.title);\r\n                    $(\"meta[name='keywords']\").attr('content', res.data['keywords']);\r\n                    $(\"meta[name='description']\").attr('content', res.data['description']);\r\n                } else {\r\n                    alert(res.message);\r\n                }\r\n            })\r\n\r\n        },\r\n        init() {\r\n            let that = this;\r\n            that.setSeo();\r\n            $(\"#pay-now\").on('click', function () {\r\n                let _this = $(this);\r\n                that.payOrder(_this);\r\n            });\r\n            $(\"#pay-methods-list>li\").on('click', function () {\r\n                let _this = $(this);\r\n                that.changePayValue(_this);\r\n            });\r\n            $(\"#form-group input[data-check],#pay-value\").on('blur', function () {\r\n                let _this = $(this);\r\n                that.blurCheck(_this);\r\n            });\r\n            $(\"#form-group input[name=receipt]\").on('change', function () {\r\n                let _this = $(this);\r\n                that.getCheck(_this);\r\n            });\r\n\r\n            $('body,#qrcode-modal span').on('click', function () {\r\n                if (that.modalShow) {\r\n                    that.modalHide();\r\n                }\r\n            })\r\n\r\n        }\r\n    }\r\n    Base.init();\r\n});"]}