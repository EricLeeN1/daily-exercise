{"version":3,"sources":["news.js"],"names":["$","jQuery","support","cors","window","Base","site","that","this","id","getQueryString","res","article","status","data","str_content","imgArrays","cat_id","content","str_title","attr","str_thumb","children","html","capture","console","element","forEach","src","append","name","reg","RegExp","r","location","search","substr","match","context","imgLoad","image","Image","onload","onerror","setSeo","log","text","title","alert","message","getAjax","url","datas","fns","fnf","ajax","type","dataType","success","fail","postAjax","init","getInfos"],"mappings":"aAAAA,EAAE,WACEC,OAAOC,QAAQC,MAAO,EADZC,OAAAC,MACHH,CACHG,KAAAA,2BACJA,SAFOH,WAGHI,IAAMC,EAAAC,KADHC,EAAAF,EAAAG,eAEQ,MACPH,EAAIA,SAAO,OAAX,CACIE,GAAAA,GACJF,SAAAI,GACIF,GAAIA,KAAAA,EAAAA,OAAAA,CACL,IAAAG,EAAeZ,EAAA,2BACNa,EAAU,GACVD,EAAUZ,EAAEc,KAAAC,YAChBH,EAAII,KAAAA,UAAJL,EAAAG,KAAAG,QACAL,EAAIM,SAAUP,MAASI,KAAAA,EAAAA,KAAvBI,WACAP,EAAQQ,SAAK,OAAWT,KAAIG,MAAKG,EAAjCX,KAAAK,EAAAG,KAAAO,WACAT,EAAQU,SAAS,MAAMC,KAAKZ,EAAIG,KAAKK,WACrCP,EAAQU,QAAR,qCAAoDR,SAAKO,EAAzDG,GACAZ,EAAQU,KAASE,KAEbR,QAAAA,IAAAA,GADJA,GAGAS,EAAYT,QAAZ,SAAAU,GACIV,IAAAA,EAAWT,EAAAD,KAAAoB,EACXV,EAAUW,QAAQD,EAAAE,KAGjBhB,EAHDiB,OAAAX,QAKJN,MAAAA,EAAQiB,YAIfnB,eAzBD,SAAAoB,GALD,IAAAC,EAAA,IAAAC,OAAA,QAAAF,EAAA,gBAAA,KAkCKG,EAAI7B,OAAO8B,SAASC,OAAOC,OAAO,GAAGC,MAAMN,GAFnDrB,EAAgB,GAMZqB,OALIA,MAAAA,IACAE,EAAI7B,EAAO8B,KAEfD,EADAF,EAAIO,OAGEA,GAAN,IAAAA,GAAA,aAAAA,EAAA,GAAAA,GAEAC,QA1CDrC,WAEA,IAAAsC,EAAA,IAAAC,MA0CHF,EA1CGG,OAAA,WA2CKF,QAAYC,IAAAA,YAERhB,EAAAA,QAAY,WAEhBe,KAAMG,IAAUpC,KAAAD,OAAYE,KAAAoB,MAGnCgB,OApDE1C,WAEAM,KAoDKD,QAAO,OAAX,GAAA,SAAAI,GACAJ,QAAAsC,IAAalC,GACT,KAAAc,EAAQoB,QACJlC,EAAAA,SAAAmC,KAAcnC,EAAKG,KAAAiC,OACnB/C,EAAE,yBAAuB+C,KAAzB,UAAApC,EAAAG,KAAA,UACAd,EAAE,4BAAyBoB,KAAK,UAAWT,EAAIG,KAAJH,cAF/CqC,MAIOrC,EAAAsC,YAMfC,QAnEGhD,SAEAiD,EAAAC,EAAAC,EAAAC,GAkECtD,EAAEuD,KAAK,CACHC,KAAM,MACNL,IAAK3C,KAAKF,KAAO6C,EACjBrC,KAAMsC,EACNK,SAAU,OACVC,QAASL,EACTM,KAAML,KAGdM,SA7EG1D,SAEAiD,EAAAC,EAAAC,EAAAC,GA4ECtD,EAAEuD,KAAK,CACHC,KAAM,OACNL,IAAK3C,KAAKF,KAAO6C,EACjBrC,KAAMsC,EACNK,SAAU,OACVC,QAASL,EACTM,KAAML,KAGdO,KAvFG3D,WAwFCuB,QAAQoB,IAAI,OACDrC,KACNsD,WADMtD,KAENoC,YAGRiB","file":"news.js","sourcesContent":["$(function () {\r\n    jQuery.support.cors = true;\r\n    let Base = window.Base || {};\r\n    Base = {\r\n        site: 'https://www.doubaner.top',\r\n        getInfos() {\r\n            let that = this;\r\n            let id = that.getQueryString('id');\r\n            that.postAjax('/new', {\r\n                id: id\r\n            }, function (res) {\r\n                if (res.status == 200) {\r\n                    let article = $('#news-body>main>article');\r\n                    let imgArrays = [];\r\n                    let content = res.data.str_content;\r\n                    article.attr('data-id', res.data.cat_id)\r\n                    article.children(\"h3\").html(res.data.str_title);\r\n                    article.children(\"img\").attr('src', that.site + res.data.str_thumb);\r\n                    article.children(\"h3\").html(res.data.str_title);\r\n                    content.replace(/<img [^>]*src=['\"]([^'\"]+)[^>]*>/gi, function (match, capture) {\r\n                        imgArrays.push(capture);\r\n                    });\r\n                    console.log(imgArrays);\r\n                    if (imgArrays) {\r\n                        imgArrays.forEach(element => {\r\n                            let src = that.site + element;\r\n                            content.replace(element, src);\r\n                        });\r\n                    }\r\n                    article.append(content);\r\n                } else {\r\n                    alert(res.message);\r\n                }\r\n            });\r\n        },\r\n        getQueryString: function (name) {\r\n            var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n            var r = window.location.search.substr(1).match(reg); //获取url中\"?\"符后的字符串并正则匹配\r\n            var context = \"\";\r\n            if (r != null)\r\n                context = r[2];\r\n            reg = null;\r\n            r = null;\r\n            return context == null || context == \"\" || context == \"undefined\" ? \"\" : context;\r\n        },\r\n        imgLoad() {\r\n            let image = new Image();\r\n            image.onload = function () {\r\n                    console.log('success');\r\n                },\r\n                image.onerror = function () {\r\n                    this.src = that.site + +this.src;\r\n                }\r\n        },\r\n        setSeo() {\r\n            let that = this;\r\n            that.getAjax('/seo', {}, function (res) {\r\n                console.log(res);\r\n                if (res.status == 200) {\r\n                    $(\"title\").text(res.data.title);\r\n                    $(\"meta[name='keywords']\").attr('content', res.data['keywords']);\r\n                    $(\"meta[name='description']\").attr('content', res.data['description']);\r\n                } else {\r\n                    alert(res.message);\r\n                }\r\n            })\r\n\r\n        },\r\n        getAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"GET\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'JSON',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        postAjax(url, datas, fns, fnf) {\r\n            $.ajax({\r\n                type: \"POST\",\r\n                url: this.site + url,\r\n                data: datas,\r\n                dataType: 'json',\r\n                success: fns,\r\n                fail: fnf\r\n            });\r\n        },\r\n        init() {\r\n            console.log('111');\r\n            let that = this;\r\n            that.getInfos();\r\n            that.setSeo();\r\n        }\r\n    }\r\n    Base.init();\r\n});"]}